/**
Name : Multi-Remark
Author:  Jesse Tomchak
License : MIT
Version : 1.0
**/

//Module Dependencies
var fs = require("fs-extra");
var child_process = require("child_process");

module.exports = {
  generate: function(deckName) {
    console.log(deckName);
    if (deckName !== undefined && deckName !== "") {
      //Multi-Deck Generator
      //Create directory with the user's given deck name on the current cli path
      fs.mkdirs("./" + deckName + "", function(err) {
        if (err) {
          console.error(err);
        } else {
          fs.writeFile(
            "./" + deckName + "/README.MD",
            "Generated By Multi-Remark Template",
            function(err) {
              if (err) {
                console.log(err);
              } else {
                // We now know that evrything is smooth
                console.log(__dirname);
                var dirname = __dirname;

                var dirstr = dirname.substr(dirname.lastIndexOf("/") + 1) + "$",
                  fixedurl = dirname.replace(new RegExp(dirstr), "");

                fs.copy(
                  fixedurl + "/templates/course/",
                  "./" + deckName + "",
                  function(err) {
                    if (err) {
                      console.error(err);
                    } else {
                      console.log("Building new Course " + deckName);
                      console.log("success!");
                      console.log("Your Multi-Deck Course is ready!");
                      console.log("cd into " + deckName);
                      console.log("run `npm install && npm start`");
                    }
                  }
                );
              }
            }
          );
        }
      });
    }
  }
};
